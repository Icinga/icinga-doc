<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter [
<!ENTITY % all.entities SYSTEM "all-entities.ent">
%all.entities;
]>
<section version="5.0" xml:id="icinga-web-config" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:svg="http://www.w3.org/2000/svg" xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml" xmlns:db="http://docbook.org/ns/docbook">
  <title>Konfigurationsübersicht &name-web;</title>

  <para><emphasis role="bold">Wo sind meine Konfigurationsdateien? </emphasis></para>

  <para>Wir versuchen die Verwendung von globalen Konfigurationsdateien zu minimieren. &name-web; arbeitet mit Modulen und jedes Modul hat
  seine eigene Konfiguration. Das gilt ebenfalls für die Libraries. Wenn Sie weitere Informationen zu den Cronk Libraries benötigen, schauen
  Sie in app/modules/Cronks/lib (für js in app/modules/Cronks/lib/js).</para>

  <para>Ein Modul von &name-web; ist wie folgt aufgebaut: <programlisting>tree -d -L 1 app/modules/AppKit/
app/modules/AppKit/
|-- actions
|-- config
|-- lib
|-- models
|-- templates
|-- validate
|-- views</programlisting></para>

  <para><emphasis role="bold">Index</emphasis></para>

  <itemizedlist>
    <listitem>
      <para><link linkend="configweb-globalconfig">Globale Konfiguration</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-session-lifetime">Session Cookie Lifetime</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-timezone">Zeitzone</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-module">Module Konfiguration</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-auth">Authentifizierung</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-api">&name-api; Verbindungseinstellung</link></para>
    </listitem>

    <listitem>
      <para><link linkend="configweb-customconfig">Benutzerdefinierte Konfiguration</link></para>
    </listitem>
  </itemizedlist>

  <para><anchor xml:id="configweb-globalconfig" /> <emphasis role="bold">Globale Konfiguration</emphasis></para>

  <para><emphasis role="bold">app/config</emphasis></para>

  <para>Hier finden Sie die globalen Konfigurationsdateien für z.B. die Web Session, den Icinga Web Pfad und die
  Datenbankinformationen.</para>

  <para>Die wichtigsten Dateien:</para>

  <itemizedlist>
    <listitem>
      <para>database.xml - enthält die Verbindungseinstellungen für Ihre &name-web; Datenbank</para>
    </listitem>

    <listitem>
      <para>factories.xml - enthält die Konfiguration für Ihre Web Session</para>
    </listitem>

    <listitem>
      <para>icinga.xml - enthält die Konfiguration für Ihr &name-web; ROOT-Verzeichnis und den Icinga Web Pfad.</para>
    </listitem>
  </itemizedlist>

  <para><anchor xml:id="configweb-session-lifetime" /> <emphasis role="bold">Session Cookie Lifetime</emphasis></para>

  <para>Beispiel: Ändern von session_cookie_lifetime</para>

  <para>Die Session Lifetime ist die Zeit in Sekunden bis die &name-web;- Session abläuft. Sie kann auf globaler Ebene in der Datei
  app/config/factories.xml konfiguriert werden.</para>

  <programlisting>#&gt; vi app/config/factories.xml

&lt;ae:parameter name="session_cookie_lifetime"&gt;3600&lt;ae:parameter&gt;</programlisting>

  <para>Wenn Sie die session_cookie_lifetime ändern möchten, editieren Sie bitte app/config/factories.site.xml</para>

  <para><anchor xml:id="configweb-timezone" /> <emphasis role="bold">&name-web;- Zeitzone</emphasis></para>

  <para>Beispiel: Ändern der Zeitzone für &name-web;</para>

  <para>Wenn die Zeitzone von &name-web; von Ihrer lokalen Zeitzone abweicht, überprüfen Sie bitte den Parameter date.timezone in
  app/modules/AppKit/config/module.xml (z.B. 'Europe/Berlin')</para>

  <programlisting>#&gt; vi app/modules/AppKit/config/module.xml
&lt;ae:parameter name="date.timezone"&gt;GMT&lt;/ae:parameter&gt;</programlisting>

  <para><anchor xml:id="configweb-module" /> <emphasis role="bold">Modul Konfiguration:</emphasis></para>

  <para><emphasis role="bold">app/modules/AppKit</emphasis></para>

  <para>Hier "lebt" das Framwork: Authentifikation, Menüs und weiteres.</para>

  <para><anchor xml:id="configweb-auth" /> <emphasis role="bold">Authentifizierung</emphasis></para>

  <para>Beispiel: LDAP- Authentifizierung</para>

  <para>Öffnen Sie app/modules/AppKit/config/auth.xml.</para>

  <para>Ein Anbieter ist wie folgt aufgebaut:</para>

  <programlisting> &lt;ae:parameter name="msad-ldap1"&gt;
            &lt;ae:parameter name="auth_module"&gt;AppKit&lt;/ae:parameter&gt;
            &lt;ae:parameter name="auth_provider"&gt;Auth.Provider.LDAP&lt;/ae:parameter&gt;
            &lt;ae:parameter name="auth_enable"&gt;true&lt;/ae:parameter&gt;
            &lt;ae:parameter name="auth_authoritative"&gt;true&lt;/ae:parameter&gt;
            &lt;ae:parameter name="auth_create"&gt;true&lt;/ae:parameter&gt;
            &lt;ae:parameter name="auth_update"&gt;true&lt;/ae:parameter&gt;

            &lt;ae:parameter name="auth_map"&gt;
                &lt;ae:parameter name="user_firstname"&gt;givenName&lt;/ae:parameter&gt;
                &lt;ae:parameter name="user_lastname"&gt;sn&lt;/ae:parameter&gt;
                &lt;ae:parameter name="user_email"&gt;mail&lt;/ae:parameter&gt; 
            &lt;/ae:parameter&gt;

            &lt;ae:parameter name="ldap_dsn"&gt;ldap://ad.icinga.org&lt;/ae:parameter&gt;
            &lt;ae:parameter name="ldap_basedn"&gt;DC=ad,DC=icinga,DC=org&lt;/ae:parameter&gt;
            &lt;ae:parameter name="ldap_binddn"&gt;ldap@AD.ICINGA.ORG&lt;/ae:parameter&gt;
            &lt;ae:parameter name="ldap_bindpw"&gt;&lt;![CDATA[XXXXXXXXX]]&gt;&lt;/ae:parameter&gt;
            &lt;ae:parameter name="ldap_userattr"&gt;uid&lt;/ae:parameter&gt;
            &lt;ae:parameter name="ldap_filter_user"&gt;&lt;![CDATA[(&amp;(sAmAccountName=__USERNAME__))]]&gt;&lt;/ae:parameter&gt;
        &lt;/ae:parameter&gt;</programlisting>

  <para>Die auth.xml hält die Dokumentation für die globale Konfiguration. Die LDAP-Authentifizierung sollte mit einigen grundlegenden LDAP-
  Kenntnissen möglich sein.</para>

  <para>Sie können die Anbieter duplizieren und so Ihre Authentifizierung- Basis zu vergrössern.</para>

  <para>Bitte speichern Sie Ihre Konfiguration in auth.site.xml !</para>

  <para><emphasis role="bold">app/modules/Cronks</emphasis></para>

  <para>Alle Cronks werden hier implementiert: Grids und iframes. Sie sind einfache HTML-Seiten die ExtJS Komponenten Code enthalten. Wenn
  Sie einen neuen Cronk hinzufügen möchten, wird dieses Modul Ihr Freund sein.</para>

  <para>Wenn Sie einen neuen Cronk entwickeln möchten, schauen Sie hier: <link
  xlink:href="https://dev.icinga.org/projects/icinga-development/wiki/HowToDevelopCronks">HowToDevelopCronks</link></para>

  <para>Die Konfiguration können Sie im Cronk- Module ändern:</para>

  <programlisting>#&gt; ls app/modules/Cronks/config
autoload.xml  config_handlers.xml  cronks.xml  module.xml  validators.xml</programlisting>

  <itemizedlist>
    <listitem>
      <para>module.xml - definieren von neuen Kategorien in denen die Cronks erscheinen, die Datei module.xml hält dazu alle
      Informationen</para>
    </listitem>

    <listitem>
      <para>cronks.xml - um auf neue Cronks zu zugreifen, definieren von neuen iframe Cronks</para>

      <para></para>
    </listitem>
  </itemizedlist>

  <para><emphasis role="bold">app/modules/Web</emphasis></para>

  <para>Oder besser:<emphasis role="bold"> Icinga</emphasis>. Dieses Modul enthält alle Icinga relevanten Dinge wie IcingaAPI2Json und die
  Status Informationen. Auch die &name-api;- Verbindungseinstellungen werden hier konfiguriert.</para>

  <para></para>

  <para><anchor xml:id="configweb-api" /> <emphasis role="bold">&name-api; Verbindungseinstellungen</emphasis></para>

  <para>Beispiel: Ändern der &name-api;-Verbindungseinstellungen</para>

  <para>Sehen Sie in app/modules/Web/config/icinga-io.xml, hier finden Sie die standard Einstellungen für die &name-api;- Verbindung.</para>

  <programlisting>#&gt; vi app/modules/Web/config/icinga-io.xml

          &lt;setting name="api.interfaces.data"&gt;
                                        &lt;!-- IcingaApi connection interface --&gt;
                                        &lt;ae:parameter name="api_type"&gt;IcingaApi::CONNECTION_IDO&lt;/ae:parameter&gt;

                                        &lt;!-- Suits for all interfaes --&gt;
                                        &lt;ae:parameter name="config_type"&gt;mysql&lt;/ae:parameter&gt;
                                        &lt;ae:parameter name="config_host"&gt;localhost&lt;/ae:parameter&gt;
                                        &lt;ae:parameter name="config_port"&gt;3306&lt;/ae:parameter&gt;

                                        &lt;!-- ###BEGIN_CONNECTION_IDO### --&gt;
                                        &lt;!-- Database specific (IcingaApi::CONNECTION_IDO) --&gt;
                                        &lt;ae:parameter name="config_database"&gt;icinga&lt;/ae:parameter&gt;
                                        &lt;ae:parameter name="config_user"&gt;icinga&lt;/ae:parameter&gt;
                                        &lt;ae:parameter name="config_password"&gt;icinga&lt;/ae:parameter&gt;
                                        &lt;ae:parameter name="config_table_prefix"&gt;icinga_&lt;/ae:parameter&gt;
                                        &lt;!-- ###END_CONNECTION_IDO### --&gt;</programlisting>

  <para>Wenn Sie diese Einstellungen ändern möchten, editieren Sie bitte app/modules/Web/config/icinga-io.site.xml.</para>

  <para><anchor xml:id="configweb-customconfig" /><emphasis role="bold">Benutzerdefinierte Konfiguration</emphasis></para>

  <para><emphasis role="bold">Bitte beachten:</emphasis></para>

  <para>Wenn Sie Konfigurationsdateien ändern oder erstellen, denken Sie bitte an folgendes:</para>

  <orderedlist>
    <listitem>
      <para>Zeilen die mit &lt;!-- beginnen und enden mit --&gt; werden als Kommentare interpretiert.</para>
    </listitem>

    <listitem>
      <para>Variablen Namen sind case-sensitive</para>
    </listitem>

    <listitem>
      <para>Ihre benutzdefinierten &name-web; Konfigurationseinstellungen für die &name-api;, die Authentifizierung und die Datenbank können
      Sie in den app/modules/Appkit(/Cronks/Web)/config/*.site.xml- Dateien vornehmen. Diese Datein werden bei einer Aktualisierung von
      &name-web; nicht überschrieben.</para>

      <para>Folgende Dateien sind dafür vorgesehen:</para>

      <para>app/modules/Cronks/config/cronks.site.xml</para>

      <para>app/modules/Web/config/icinga-io.site.xml</para>

      <para>app/modules/AppKit/config/auth.site.xml</para>

      <para>app/config/icinga.site.xml</para>

      <para>app/config/databases.site.xml</para>

      <para>app/config/settings.site.xml</para>

      <para>app/config/translation.site.xml</para>

      <para>app/config/factories.site.xml</para>

      <para></para>

      <para>Die Templates für Grids and TO's (tactical overview) können in ihrem Verzeichnis zu *.site.xml- Dateien kopiert werden:</para>

      <para><emphasis role="bold">Die Grids:</emphasis></para>

      <para>app/modules/Cronks/data/xml/grid/icinga-hostgroup-summary-template.xml</para>

      <para>app/modules/Cronks/data/xml/grid/icinga-host-history-template.xml</para>

      <para>app/modules/Cronks/data/xml/grid/icinga-host-template.xml</para>

      <para>....</para>

      <para><emphasis role="bold">und die TO's:</emphasis></para>

      <para>app/modules/Cronks/data/xml/to/icinga-tactical-overview-groupstat.xml</para>

      <para>app/modules/Cronks/data/xml/to/icinga-tactical-overview-presets.xml</para>

      <para>app/modules/Cronks/data/xml/to/icinga-tactical-overview-template-charts.xml</para>

      <para>...</para>

      <para>Um auf Ihre *.site.xml- Grids/Cronks zugreifen zu können, müssen Sie diese in app/modules/Cronks/config/cronks.xml
      hinterlegen.</para>
    </listitem>
  </orderedlist>

  <note>
    <para>Nachdem ändern von Konfigurationsdateien, leeren Sie bitte den Cache!</para>
  </note>

  <programlisting> #&gt; rm -rf app/cache/config/*.php</programlisting>

  <para>oder</para>

  <programlisting>#&gt; /icinga-web/bin/clearcache.sh</programlisting>

  <para>Benötigen Sie weitere Informationen? Schauen Sie bitte in unserem<link
  xlink:href="https://dev.icinga.org/projects/icinga-development/wiki/"> Development Wiki.</link></para>

  <indexterm zone="icinga-web-config">
    <primary>Konfigurationsoptionen &name-web;</primary>
  </indexterm>

  <indexterm zone="icinga-web-config">
    <primary>&name-web;</primary>
    <secondary>Konfigurationsoptionen</secondary>
  </indexterm>

  <indexterm zone="icinga-web-config">
    <primary>benutzerdefinierte Konfiguration &name-web;</primary>
  </indexterm>

  <indexterm zone="icinga-web-config">
    <primary>&name-web;</primary>
    <secondary>benutzerdefinierte Konfiguration</secondary>
  </indexterm>

  <indexterm zone="configweb-session-lifetime">
    <primary>Session Lifetime &name-web;</primary>
  </indexterm>

  <indexterm zone="configweb-session-lifetime">
    <primary>&name-web;</primary>
    <secondary>Session Lifetime</secondary>
  </indexterm>

  <indexterm zone="configweb-timezone">
    <primary>Timezone &name-web;</primary>
  </indexterm>

  <indexterm zone="configweb-timezone">
    <primary>Zeitzone &name-web;</primary>
  </indexterm>

  <indexterm zone="configweb-timezone">
    <primary>&name-web;</primary>
    <secondary>Zeitzone</secondary>
  </indexterm>
</section>
