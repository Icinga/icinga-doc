<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Benutzen des Embedded Perl Interpreters</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.75.1">
<meta name="keywords" content="Supervision, Icinga, Icinga, Linux">
<link rel="home" href="index.html" title="Icinga Version 0.8.4 Dokumentation">
<link rel="up" href="ch06.html" title="Kapitel 6. Fortgeschrittene Themen">
<link rel="prev" href="downtime.html" title="Geplante Ausfallzeiten">
<link rel="next" href="adaptive.html" title="Adaptive Überwachung">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<CENTER><IMG src="images/logofullsize.png" border="0" alt="Icinga" title="Icinga"></CENTER>
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Benutzen des Embedded Perl Interpreters</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="downtime.html">Zurück</a> </td>
<th width="60%" align="center">Kapitel 6. Fortgeschrittene Themen</th>
<td width="20%" align="right"> <a accesskey="n" href="adaptive.html">Vor</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="section" title="Benutzen des Embedded Perl Interpreters">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="embeddedperl"></a>Benutzen des Embedded Perl Interpreters</h2></div></div></div>
  

  <div class="informaltable">
    <table border="0">
<colgroup>
<col>
<col>
</colgroup>
<tbody><tr>
<td align="left" valign="top">
<p>
               

              <span class="bold"><strong>Einführung</strong></span>

               
            </p> <p>Icinga kann für die Unterstützung eines eingebetteten Perl-Interpreters (embedded perl
          interpreter) kompiliert werden. Dies erlaubt es Icinga, Perl-Plugins effizienter als sonst auszuführen, also mag
          es interessant sein, wenn Sie sich viel auf Plugins verlassen, die in Perl geschrieben sind.</p> <p>Ohne den
          eingebetteten Perl-Interpreter führt Icinga Perl- (und andere) Plugins durch "forking" und ausführen als einen
          externen Befehl aus. Wenn der eingebettete Perl-Interpreter benutzt wird, kann Icinga Perl-Plugins durch einen
          einfachen Library-Call ausführen.</p> <p><span class="inlinemediaobject"><img src="images/tip.gif"></span> Hinweis: Der Perl-Interpreter arbeitet mit allen Perl-Scripten, die Icinga ausführt -
          nicht nur Plugins. Diese Dokumentation behandelt den eingebetteten Perl-Interpreter in Verbindung mit Plugins für Host-
          und Service-Prüfungen, aber sie trifft genauso auf andere Arten von Perl-Scripten zu, die Sie vielleicht für andere
          Arten von Befehlen benutzen (z.B. Benachrichtigungs-Scripte, Eventhandler-Scripte usw.).</p> <p>Stephen Davis hat
          den originalen eingebetteten Perl-Interpreter-Code vor einigen Jahren beigetragen. Stanley Hopcroft war die erste
          Person, die geholfen hat, den eingebetteten Perl-Interpreter-Code zu verbessern und die die Vor- und Nachteile bei der
          Benutzung kommentiert hat. Er hat auch verschiedene hilfreiche Hinweise zur Erstellung von Perl-Plugins gegeben, die
          sauber mit dem eingebetteten Interpreter arbeiten.</p> <p>Es sollte angemerkt werden, dass sich "ePN" - wie in
          dieser Dokumentation benutzt - auf "embedded Perl Icinga" bezieht, oder wenn Sie das bevorzugen, Icinga
          mit eingebettetem Perl-Interpreter.</p>
</td>
<td align="left" valign="top"><p> <span class="inlinemediaobject"><img src="images/epn.png"></span> </p></td>
</tr></tbody>
</table>
  </div>

  <p><span class="bold"><strong>Vorteile</strong></span></p>

  <p>Einige Vorteile von ePN (embedded Perl Icinga) umfassen:</p>

  <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
      <p>Icinga wird viel weniger Zeit bei der Ausführung Ihrer Perl-Plugins verbringen, weil es nicht länger "fork"t,
      um das Plugin auszuführen (das Laden des Perl-Interpreters entfällt). Statt dessen führt es das Plugin durch einen
      Library-Call durch.</p>
    </li>
<li class="listitem">
      <p>es reduziert die Systembelastung durch Perl-Plugins und/oder erlaubt es Ihnen, mehr Prüfungen mit Perl-Plugins
      durchzuführen, als Ihnen das sonst möglich wäre. Mit anderen Worten haben Sie weniger Anreiz, Plugins in anderen Sprachen
      wie z.B. C/C++, oder Expect/TCL zu schreiben, die bei den Entwicklungszeiten eine Zehnerpotenz langsamer angesehen werden
      als Perl (wobei sie auch zehnmal schneller ablaufen, von TCL mal abgesehen).</p>
    </li>
<li class="listitem">
      <p>Wenn Sie kein C-Programmierer sind, dann können Sie trotzdem eine Menge mit Perl erledigen, ohne dass es Icinga
      viel langsamer macht. Beachten Sie, dass ePN Ihre Plugins nicht schneller macht (außer, dass es die Ladezeit eliminiert).
      Wenn Sie schnelle Plugins wollen, dann berücksichtigen Sie Perl XSUBs (XS) oder C, <span class="emphasis"><em>nachdem</em></span> Sie sicher
      sind, dass Sie Ihr Perl getuned haben und dass Sie einen angemessenen Algorithmus haben (Benchmark.pm is
      <span class="emphasis"><em>unbezahlbar</em></span> für den Vergleich von Perl-Sprachelementen).</p>
    </li>
<li class="listitem">
      <p>ePN zu benutzen ist eine exzellente Gelegenheit, mehr über Perl zu lernen.</p>
    </li>
</ul></div>

  <p><span class="bold"><strong>Nachteile</strong></span></p>

  <p>Die Nachteile von ePN (embedded Perl Icinga) sind ziemlich die gleichen wie bei Apache mod_perl (d.h.
  Apache mit einem eingebetteten Interpreter) verglichen mit einem schlichten Apache:</p>

  <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
      <p>Ein Perl-Programm, das <span class="emphasis"><em>wunderbar</em></span> mit schlichtem Icinga arbeitet, muss
      <span class="emphasis"><em>nicht</em></span> mit ePN funktionieren. Möglicherweise müssen Sie Ihre Plugins modifizieren, damit sie
      funktionieren.</p>
    </li>
<li class="listitem">
      <p>Perl-Plugins sind unter ePN schwieriger zu debuggen als unter schlichtem Icinga.</p>
    </li>
<li class="listitem">
      <p>Ihr ePN wird eine größere SIZE (Speichernutzung) haben als ein schlichtes Icinga.</p>
    </li>
<li class="listitem">
      <p>Einige Perl-Konstrukte können nicht genutzt werden oder mögen sich anders verhalten als Sie das erwarten
      würden.</p>
    </li>
<li class="listitem">
      <p>Sie sollte sich bewusst sein, dass es 'mehr als einen Weg gibt, es zu tun' und ggf. einen Weg wählen, der weniger
      attraktiv oder offensichtlich ist.</p>
    </li>
<li class="listitem">
      <p>Sie werden mehr Perl-Know-How benötigen (aber nichts sehr esoterisches oder Zeug über Perl-Interna - außer, wenn Ihre
      Plugins XSUBS benutzen).</p>
    </li>
</ul></div>

  <p><span class="bold"><strong>Benutzung des eingebetteten Perl-Interpreters</strong></span></p>

  <p>Wenn Sie den eingebetteten Perl-Interpreter benutzen wollen, um Ihre Perl-Plugins und Scripts auszuführen, dann lesen Sie
  hier, was Sie tun müssen:</p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p>Kompilieren Sie Icinga mit Unterstützung für den eingebetteten Perl-Interpreter (Anweisungen s.u.).</p>
    </li>
<li class="listitem">
      <p>aktivieren Sie die <a class="link" href="configmain.html#configmain-enable_embedded_perl">enable_embedded_perl</a>-Option in der
      Hauptkonfigurationsdatei.</p>
    </li>
<li class="listitem">
      <p>setzen Sie die <a class="link" href="configmain.html#configmain-use_embedded_perl_implicitly">use_embedded_perl_implicitly</a>-Option
      entsprechend Ihren Anforderungen. Diese Option legt fest, ob der Perl-Interpreter per Default für einzelne Perl-Plugins und
      Scripts benutzt werden sollte.</p>
    </li>
<li class="listitem">
      <p>Optional sollten Sie bei verschiedenen Perl-Plugins und Scripts die Ausführung durch den eingebetteten
      Perl-Interpreter aktivieren oder deaktivieren. Das kann nützlich sein, wenn bestimmte Perl-Scripte Probleme bei der
      Ausführung mit dem Perl-Interpreter haben. Beachten Sie die Anweisungen weiter unten für mehr Informationen, wie das zu tun
      ist.</p>
    </li>
</ol></div>

  <p><span class="bold"><strong>Icinga mit eingebettetem Perl kompilieren</strong></span></p>

  <p>Wenn Sie den eingebetteten Perl-Interpreter benutzen möchten, müssen Sie zuerst Icinga mit der Unterstützung dafür
  kompilieren. Um dies zu tun, starten Sie einfach das configure-Script zusätzlich mit der <span class="color">
  <span class="emphasis"><em>--enable-embedded-perl</em></span> </span> -Option. Wenn Sie aktivieren wollen, dass der Perl-Interpreter intern
  kompilierte Scripts in einem Cache ablegen soll, dann nutzen Sie die <span class="color">
  <span class="emphasis"><em>--with-perlcache</em></span> </span> -Option. Beispiel:</p>

  <pre class="screen"> ./configure --enable-embedded-perl --with-perlcache <span class="emphasis"><em> otheroptions...</em></span> </pre>

  <p>Sobald Sie das configure-Script mit den neuen Optionen ausgeführt haben, müssen Sie Icinga erneut
  kompilieren.</p>

  <p><span class="bold"><strong>Plugin-spezifische Benutzung des Perl-Interpreters</strong></span></p>

  <p>Beginnend mit Icinga 3 könenn Sie angeben, welche Perl-Plugins oder Scripts mit dem eingebetteten Perl-Interpreter
  ablaufen sollen und welche nicht. Das ist besonders dann nützlich, wenn Sie Perl-Scripte haben, die nicht sauber mit dem
  Perl-Interpreter laufen.</p>

  <p>Um Icinga <span class="emphasis"><em>explizit</em></span> mitzuteilen, ob der Perl-Interpreter benutzt werden soll oder nicht, fügen
  Sie Ihrem Perl-Script/Plugin einen der folgenden Einträge hinzu...</p>

  <p>Um Icinga mitzuteilen, den Perl-Interpreter für ein bestimmtes Script zu nutzen, fügen Sie dem Perl-Script diese
  Zeile hinzu:</p>

  <pre class="screen"> # nagios: +epn</pre>

  <p>Um Icinga mitzuteilen, den Perl-Interpreter für ein bestimmtes Script NICHT zu nutzen, fügen Sie dem Perl-Script
  diese Zeile hinzu:</p>

  <pre class="screen"> # nagios: -epn</pre>

  <p>Eine der beiden Zeilen muss innerhalb der ersten zehn Zeilen stehen, damit sie von Icinga erkannt wird.</p>

  <p><span class="inlinemediaobject"><img src="images/tip.gif"></span> Hinweis: Wenn Sie nicht <span class="emphasis"><em>explizit</em></span> die oben genannte Methode nutzen, um Icinga
  mitzuteilen, den Perl-Interpreter für ein einzelnes Plugin zu nutzen, wird Icinga eine Entscheidung für Sie treffen.
  Dieser Entscheidungsprozess wird von der <a class="link" href="configmain.html#configmain-use_embedded_perl_implicitly">use_embedded_perl_implicitly</a>-Variable kontrolliert. Wenn der Wert auf 1
  gesetzt ist, werden alle Perl-Plugins/Scripts (bei denen nicht explizit der ePN aktiviert/deaktiviert ist) mit dem
  Perl-Interpreter ausgeführt. Wenn der Wert auf 0 gesetzt ist, werden sie NICHT mit dem Perl-Interpreter ausgeführt.</p>

  <p><span class="bold"><strong>Plugins für die Nutzung mit Embedded Perl entwickeln</strong></span></p>

  <p>Informationen über die Entwicklung von Plugins zur Nutzung mit dem eingebetteten Perl-Interpreter finden Sie <a class="link" href="epnplugins.html" title="Entwickeln von Plugins für die Nutzung mit Embedded Perl">hier</a>.</p>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="downtime.html">Zurück</a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch06.html">Seitenanfang</a></td>
<td width="40%" align="right"> <a accesskey="n" href="adaptive.html">Vor</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Geplante Ausfallzeiten </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Übersicht</a></td>
<td width="40%" align="right" valign="top"> Adaptive Überwachung</td>
</tr>
</table>
</div>
<P class="copyright">© 2009 Icinga Development Team, http://www.icinga.org</P>
</body>
</html>
